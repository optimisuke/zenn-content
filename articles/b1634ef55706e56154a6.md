---
title: "DELETEã¨INSERTã¨UPDATEã‚’ã²ã¨ã¤ã®SQLã§å®Ÿæ–½ã—ãŸã£ãŸ"
emoji: "ğŸ™†"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---

# ã¯ã˜ã‚ã«
SQLåŠ›ãŒä½ã„ã®ã§ã€è¤‡é›‘ãªã‚¯ã‚¨ãƒªæ›¸ãå¿…è¦ãŒå‡ºã¦ãã‚‹ã¨ã™ãã«æ™‚é–“ãŒã¨ã‘ã‚‹ã€‚

# èª¿ã¹ãŸãƒªãƒ³ã‚¯
## with
[PostgreSQL: Documentation: 9.1: WITH Queries (Common Table Expressions)](https://www.postgresql.org/docs/9.1/queries-with.html)
[WITHå•ã„åˆã‚ã›ï¼ˆå…±é€šãƒ†ãƒ¼ãƒ–ãƒ«å¼ï¼‰](https://www.postgresql.jp/document/9.4/html/queries-with.html)

å¹³è¡Œã«å‡¦ç†ã™ã‚‹

> This alleviates the effects of the unpredictability of the actual order of row updates, and means that RETURNING data is the only way to communicate changes between different WITH sub-statements and the main query.

> ã“ã®ãŸã‚äº’ã„ãŒå¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¡Œã£ãŸå½±éŸ¿ã‚’"è¦‹ã‚‹"ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ã“ã‚Œã¯ã€è¡Œã®æ›´æ–°ã«é–¢ã™ã‚‹å®Ÿéš›ã®é †åºãŒäºˆæ¸¬ã§ããªã„ã¨ã„ã†å½±éŸ¿ã‚’è»½æ¸›ã—ã€RETURNINGãƒ‡ãƒ¼ã‚¿ãŒåˆ¥ã®WITHå‰¯æ–‡ã¨ä¸»å•ã„åˆã‚ã›ã¨ã®é–“ã§å¤‰æ›´ã‚’ä¼ãˆã‚‹å”¯ä¸€ã®æ‰‹æ®µã§ã‚ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚

## insert
[PostgreSQL: Documentation: 9.5: INSERT](https://www.postgresql.org/docs/9.5/sql-insert.html#:~:text=ON%20CONFLICT%20DO%20UPDATE%20guarantees,%E2%80%94%20%22UPDATE%20or%20INSERT%22.)

## delete
[DELETE](https://www.postgresql.jp/document/9.2/html/sql-delete.html)
[PostgreSQL: Documentation: 10: DELETE](https://www.postgresql.org/docs/10/sql-delete.html)
[PostgreSQLã§JOINã—ãŸçµæœã‚’DELETEã™ã‚‹ | KAILO](https://kailo.jp/post/10)

## array
[PostgreSQL: Documentation: 9.2: Arrays](https://www.postgresql.org/docs/9.2/arrays.html)
[sql - Store select query's output in one array in postgres - Stack Overflow](https://stackoverflow.com/questions/6402043/store-select-querys-output-in-one-array-in-postgres/6402163)
[PostgresQL SQL: Converting results to array - Stack Overflow](https://stackoverflow.com/questions/5723851/postgresql-sql-converting-results-to-array)
[PostgreSQL: Documentation: 9.1: Row and Array Comparisons](https://www.postgresql.org/docs/9.1/functions-comparisons.html)


## row_number()
[PostgreSQL ROW_NUMBER() Explained with Practical Examples](https://www.postgresqltutorial.com/postgresql-row_number/)
[#PostgreSQL Windowé–¢æ•°ã§è¡Œç•ªå·ã‚„é †ä½ã‚’æŠ½å‡º - Qiita](https://qiita.com/nfnoface/items/72609615ede93ecea349)

## WITH ORDINALITY
[PostgreSQL: Documentation: 12: 7.2.Â Table Expressions](https://www.postgresql.org/docs/12/queries-table-expressions.html)

## go
`pq.StringArray`ã§ã‚ãŸã—ã¦ã‚‹ã®ã§ã€arrayã¨ã—ã¦èªè­˜ã•ã‚Œã‚‹ã€‚ä»–ã«ã‚‚`pq.Int64Array`ç­‰ã‚‚ã‚ã‚‹
[Illustrated Guide to SQLX](https://jmoiron.github.io/sqlx/#namedParams)
[Named parameters don't work with IN statement Â· Issue #485 Â· jmoiron/sqlx](https://github.com/jmoiron/sqlx/issues/485)
[loops - How to increment all elements in an array or slice in golang - Stack Overflow](https://stackoverflow.com/questions/53507260/how-to-increment-all-elements-in-an-array-or-slice-in-golang)
